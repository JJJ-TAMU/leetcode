#### Idea: cache used pairs and extend on fly
#### K-way merge