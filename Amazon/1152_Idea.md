1. first group same user data together
2. sort each group data
3. for each group, generate a pattern list
4. union the patterns using a map